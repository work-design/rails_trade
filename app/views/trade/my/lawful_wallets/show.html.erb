<%= render 'top_bar' %>

<div class="weui-panel">
  <div class="weui-panel__hd level is-flex">
    <span class="level-left">充值</span>
    <div class="level-right mt-0 pr-3 has-text-weight-normal">
      <span><%= Trade::Wallet.human_attribute_name(:amount) %>：<%= @wallet.amount.to_fs(:rounded, precision: @wallet.wallet_template.digit) %></span>
      <span><%= @wallet.wallet_template.unit %></span>
      <%= link_to '记录', { controller: 'wallet_logs', wallet_id: @wallet.id } if @wallet.id %>
    </div>
  </div>
  <div class="weui-panel__bd">
    <div class="columns m-4 is-flex is-multiline is-mobile">
      <%= render partial: 'advance', collection: advances.without_card, as: :advance %>
    </div>
    <% @wallet.unopened_advances.with_card.group_by(&:card_template).each do |card_template, advances| %>
    <div class="mx-4">
      <strong><%= card_template.name %>专享</strong>
    </div>
    <div class="columns m-4 is-flex is-multiline is-mobile">
      <%= render partial: 'advance', collection: advances, as: :advance %>
    </div>
    <% end %>
  </div>
</div>
