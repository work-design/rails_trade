<div class="weui-panel">
  <div class="weui-panel__bd">
  <% model.trade_items.each do |trade_item| %>
    <%= link_to({ action: 'show', id: model.id }, class: 'weui-media-box weui-media-box_appmsg') do %>
      <div class="weui-media-box__hd">
        <%= image_tag trade_item.good.logo, class: 'weui-media-box__thumb' if trade_item.good.logo.attached? %>
      </div>
      <div class="weui-media-box__bd">
        <h4 class="weui-media-box__title"><%= trade_item.good.name %></h4>
        <p class="weui-media-box__desc">
          <span class="has-text-danger"><%= trade_item.single_price.to_money.format(html_wrap: true).html_safe %></span>
          <span class="has-text-grey-lighter">x</span>
          <span class="is-size-7"><%= trade_item.number %></span>
        </p>
        <% if trade_item.produce_plan %>
          <p class="weui-media-box__desc">提货：<%= trade_item.produce_plan.produce_on %></p>
        <% end %>
      </div>
    <% end %>
  <% end %>
  </div>
  <div class="weui-panel__ft has-border-top">
    <div class="weui-media-box weui-media-box_text pb-1 pt-2">
      <ul class="weui-media-box__info m-0">
        <li class="weui-media-box__info__meta">
          <span>总价：</span>
          <span><%= model.amount.to_money.format(html_wrap: true).html_safe %></span>
        </li>
        <li class="weui-media-box__info__meta"><span class="weui-badge"><%= model.payment_status_i18n %></span></li>
        <li class="weui-media-box__info__meta weui-media-box__info__meta_extra">
          <span>共</span>
          <span><%= model.trade_items_count %></span>
          <span>份</span>
        </li>
      </ul>
      <ul class="weui-media-box__info mt-2">
        <li class="weui-media-box__info__meta">
          <span>下单时间：</span>
          <time data-controller="time"><%= model.created_at.to_fs(:iso8601) %></time>
        </li>
      </ul>
    </div>
    <div class="weui-cell weui-cell_link">
      <div class="weui-cell__bd"></div>
      <div class="weui-cell__ft is-flex">
        <%= button_to({ action: 'cancel', id: model.id }, method: :patch, class: 'weui-btn weui-btn_mini weui-btn_default weui-wa-hotarea ml-2', form: { class: '' }) do %>
          <span>取消订单</span>
        <% end if model.can_cancel? %>
        <%= link_to({ action: 'show', id: model.id }, class: 'weui-btn weui-btn_mini weui-btn_default weui-wa-hotarea ml-2') do %>
          <span>售后</span>
        <% end if model.all_paid? %>
        <%= link_to({ action: 'payment_types', id: model.id }, class: 'weui-btn weui-btn_mini weui-btn_primary weui-wa-hotarea ml-2') do %>
          <span>去支付</span>
        <% end if model.can_pay? %>
      </div>
    </div>
  </div>
</div>
